@model QlyDonHang_DoAn_hqtcsdl.Models.OrderDetailViewModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Hóa Đơn #@Model.OrderNo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS cho chế độ xem trên màn hình (Dark Mode Cyberpunk) */
        body {
            background-color: #0b0c15;
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
        }
        .invoice-box {
            max-width: 800px;
            margin: auto;
            padding: 30px;
            border: 1px solid #0dcaf0;
            background: #0b1221;
            box-shadow: 0 0 20px rgba(13, 202, 240, 0.2);
            position: relative;
        }
        .header-title { color: #0dcaf0; font-weight: bold; letter-spacing: 2px; }
        .table-custom th { background-color: #151e32; color: #ccff00; border-bottom: 2px solid #7c3aed; }
        .table-custom td { color: #e2e8f0; border-color: rgba(255,255,255,0.1); }
        .total-amount { font-size: 1.5rem; color: #0dcaf0; font-weight: bold; }

        /* Dấu đóng dấu ĐÃ HỦY */
        .cancelled-stamp {
            position: absolute;
            top: 150px;
            left: 50%;
            transform: translateX(-50%) rotate(-15deg);
            color: rgba(220, 53, 69, 0.5);
            font-size: 5rem;
            font-weight: bold;
            border: 5px solid rgba(220, 53, 69, 0.5);
            padding: 10px 40px;
            text-transform: uppercase;
            z-index: 10;
            pointer-events: none;
        }

        @@media print {
            body { background-color: #fff !important; color: #000 !important; -webkit-print-color-adjust: exact; }
            .invoice-box { border: 1px solid #000; box-shadow: none; background: #fff !important; }
            .header-title { color: #000 !important; }
            .table-custom th { background-color: #eee !important; color: #000 !important; border-bottom: 1px solid #000; }
            .table-custom td { color: #000 !important; border-bottom: 1px solid #ddd; }
            .total-amount { color: #000 !important; }
            .btn-print { display: none; }
            .cancelled-stamp { border-color: red; color: red; opacity: 0.3; }
        }
    </style>
</head>
<body>

    <div class="invoice-box">
        @if (Model.Status != null && Model.Status.Contains("Hủy"))
        {
            <div class="cancelled-stamp">ĐÃ HỦY</div>
        }

        <div class="d-flex justify-content-between mb-4">
            <div>
                <h1 class="header-title">FASHION SHOP</h1>
                <div>Địa chỉ: 123 ABC, TP.HCM</div>
                <div>Hotline: 1900 1234</div>
            </div>
            <div class="text-end">
                <h3 class="fw-bold">HÓA ĐƠN</h3>
                <div>Mã số: <strong>#@Model.OrderNo</strong></div>
                <div>Ngày: @Model.OrderDate.ToString("dd/MM/yyyy HH:mm")</div>
                <div>Trạng thái: @Model.Status</div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-6">
                <h5 class="border-bottom pb-2">Người nhận</h5>
                <div><strong>@Model.CustomerName</strong></div>
                <div>@Model.ShippingAddress</div>
                <div>SĐT: @Model.ShippingPhone</div>
            </div>
        </div>

        <table class="table table-custom">
            <thead>
                <tr>
                    <th>Sản phẩm</th>
                    <th class="text-center">SL</th>
                    <th class="text-end">Đơn giá</th>
                    <th class="text-end">Thành tiền</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Items)
                {
                    <tr>
                        <td>@item.ProductName</td>
                        <td class="text-center">@item.Quantity</td>
                        <td class="text-end">@item.UnitPrice.ToString("N0")</td>
                        <td class="text-end">@item.TotalPrice.ToString("N0")</td>
                    </tr>
                }
            </tbody>
        </table>

        <div class="row justify-content-end">
            <div class="col-5">
                <div class="d-flex justify-content-between mb-2">
                    <span>Tạm tính:</span>
                    <span>@Model.SubTotal.ToString("N0")</span>
                </div>
                <div class="d-flex justify-content-between mb-2">
                    <span>Phí vận chuyển:</span>
                    <span>@Model.ShippingFee.ToString("N0")</span>
                </div>
                <div class="d-flex justify-content-between border-top pt-2">
                    <span class="fs-5 fw-bold">Tổng cộng:</span>
                    <span class="total-amount">@Model.TotalAmount.ToString("N0") đ</span>
                </div>
            </div>
        </div>

        <div class="text-center mt-5 small">
            <p>Cảm ơn quý khách đã mua hàng!</p>
        </div>
    </div>

    <button class="btn btn-info btn-print position-fixed bottom-0 end-0 m-4 fw-bold" onclick="window.print()">
        <i class="fas fa-print me-2"></i> In Hóa Đơn
    </button>

</body>
</html>